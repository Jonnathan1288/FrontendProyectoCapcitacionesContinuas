<div class="card">
    <p-toolbar styleClass="mb-4">
        <ng-template pTemplate="left">
            <!-- <button pButton pRipple label="Nuevo" icon="pi pi-plus" class="p-button-success mr-2"
                (click)="showModaL()"></button> -->
            <!-- <button pButton pRipple label="Nuevo" icon="pi pi-plus" class="p-button-success mr-2" (click)="showModaL()"
                [disabled]="curso.estadoAprovacionCurso !== 'A'"></button> -->

                <button pButton pRipple label="Nuevo" icon="pi pi-plus" class="p-button-success mr-2" (click)="limpiarCampos(); showModaL()"
  [disabled]="curso.estadoAprovacionCurso !== 'A'"></button>


        </ng-template>

        <ng-template pTemplate="right">
            <button pButton pRipple label="Imprimir" icon="pi pi-print" class="p-button-primary mr-2 inline-block"
                (click)="getReportRegistroFotograficoCurso()" [disabled]="curso.estadoAprovacionCurso !== 'A'"></button>

        </ng-template>
    </p-toolbar>

    <p-table #dt [value]="listRegistroFotografico" [rows]="5" [paginator]="true"
        [globalFilterFields]="['descripcionFoto','fecha','representative.name','status']" responsiveLayout="scroll"
        [rowHover]="true" dataKey="id"
        currentPageReportTemplate="Mostrando {first} de {last} de {totalRecords} registros fotográficos"
        [showCurrentPageReport]="true">
        <ng-template pTemplate="caption">
            <div class="flex align-items-center justify-content-between">
                <!-- <h5 class="m-0"><strong>CURSO: </strong> {{curso.nombreCurso!}}</h5> -->
                <h5 class="m-0"><strong>CURSO: </strong> {{ curso.nombreCurso! }}{{ curso.estadoAprovacionCurso !== 'A'
                    ? ' (No aprobado)' : '' }}</h5>

                <span class="p-input-icon-left">
                    <i class="pi pi-search"></i>
                    <input pInputText type="text" placeholder="Search..."
                        (input)="dt.filterGlobal($any($event.target).value, 'contains')" />
                </span>
            </div>
        </ng-template>
        <ng-template pTemplate="header">
            <tr>

                <th><strong>FOTO</strong></th>

                <th pSortableColumn="descripcionFoto"> <strong>DESCRIPCIÓN</strong><p-sortIcon
                        field="descripcionFoto"></p-sortIcon></th>
                <th pSortableColumn="fecha"> <strong>FECHA</strong><p-sortIcon field="fecha"></p-sortIcon></th>

                <th pSortableColumn="inventoryStatus"> <strong>GESTIÓN</strong></th>

            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-regFotografico>
            <tr>
                
            

                    <!-- <td>
                        <img [src]="obtenerURLImagen(regFotografico)"
                             [alt]="regFotografico.name" width="100" class="shadow-4" />
                      </td> -->
                      
                
                      <td>
                        <img [src]="obtenerURLImagen(regFotografico) ? obtenerURLImagen(regFotografico) : '../../../../assets/img/subir.png'"
                          [alt]="regFotografico.name" width="100" class="shadow-4" />
                      </td>
                      
                <td>{{regFotografico.descripcionFoto}}</td>
                <td>{{regFotografico.fecha}}</td>
                <td>
                    <!-- <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-success mr-2" pTooltip="Editar" tooltipPosition="top"
                        (click)="cargarDatosRegistrofotografico(regFotografico)"
                        [disabled]="curso.estadoAprovacionCurso !== 'A'"></button> -->
                        <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-success mr-2" pTooltip="Editar"
                        tooltipPosition="top" (click)="cargarDatosRegistrofotografico(regFotografico)"
                        [disabled]="curso.estadoAprovacionCurso !== 'A'"></button>
                    <button pButton pRipple [icon]="regFotografico.estado ? 'pi pi-trash' : 'pi pi-check'" tooltipPosition="top"
                        [pTooltip]="regFotografico.estado ? 'Desactivar' : 'Activar'"
                        [class]="'p-button-rounded ' + (regFotografico.estado ? 'p-button-warning' : 'p-button-primary') + ' mt-1'"
                        (click)="eliminadoLogicoDelregistroFotografico(regFotografico)"
                        [disabled]="curso.estadoAprovacionCurso !== 'A'">
                    </button>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="summary">
            <div class="flex align-items-center justify-content-between">
                En total hay {{listRegistroFotografico ? listRegistroFotografico.length : 0 }} Registros fotográficos.
            </div>
        </ng-template>
    </p-table>
</div>


<!-- IMPLEMENTACION DEL MODAL PARA EL INGRESO DE REGISTRO FOTOGRAFICO -->
<p-dialog header="Registro fotográfico del curso" [(visible)]="visible" [modal]="true"
    [style]="{ width: '50vw', height: '280' }" [draggable]="false" [resizable]="false">
    <form (ngSubmit)="validacionRegistroFotografico()" novalidate style="padding: 15px;">

        <!-- <p-card header="Registro fotográfico del curso"> -->
        <div class="row rounded mb-1">

            <div class="col-md-6">
                <div class="grid p-fluid">
                    <div class="col-12 md:col-12" style="align-items: center;">

                        <!-- <div class="card flex justify-content-center"> -->
                        <span class="p-float-label">
                            <textarea id="float-input" rows="9" cols="30" pInputTextarea id="descripcionCurso"
                                name="descripcionCurso" [(ngModel)]="registroFotografico.descripcionFoto"
                                ></textarea>
                            <label for="float-input">Descripción de la foto</label>
                        </span>
                        <!-- </div> -->

                    </div>
                </div>

                <div class="grid p-fluid">
                    <div class="col-12 md:col-12" style="align-items: center;">
                        <div class="p-inputgroup">
                            <!-- <p-calendar inputId="edad" class="ng-dirty" [showIcon]="true"
                                placeholder="Fecha de evidencia" id="fechaEvidencia" name="fechaEvidencia"
                                [(ngModel)]="registroFotografico.fecha"></p-calendar> -->
                                <div class="p-inputgroup">
                                    <p-calendar inputId="edad" class="ng-dirty" [showIcon]="true"
                                        placeholder="Fecha de evidencia" id="fechaEvidencia" name="fechaEvidencia"
                                        [(ngModel)]="registroFotografico.fecha" [appendTo]="'body'"></p-calendar>
                                </div>
                            
                            
  

                            <p-overlayPanel #op>
                                <h6><b>Fecha de inicio y fin:</b></h6>
                                <p-divider></p-divider>
                                <p><b>inicio:</b> {{curso.fechaInicioCurso}} </p>
                                <p><b>fin:</b> {{curso.fechaFinalizacionCurso}}</p>
                            </p-overlayPanel>
                            <p-button icon="pi pi-question" styleClass="p-button-secondary p-button-text"
                                (click)="op.toggle($event)"></p-button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">

                <div class="grid p-fluid">
                    <div class="col-12 md:col-12" style="align-items: center;">
                        <div class="container custom-text-center" style="font-size: 20px;">
                            <strong>Foto evidencia</strong>
                        </div>
                    </div>
                </div>

            <div class="grid p-fluid">
    <div class="col-12 md:col-12" style="align-items: center;">
        <div class="personal-image">
            <label class="label" style="border: black;">
              <input type="file" accept="image/jpeg, image/jpg, image/png" (change)="onFileSelected($event)" />
              <figure class="personal-figure">
                <img *ngIf="previewImageUrl" [src]="previewImageUrl" class="personal-avatar" alt="Previsualización de imagen" />
                <img *ngIf="!previewImageUrl" src="./assets/img/subir.png" class="personal-avatar" alt="Imagen de marcador de posición" />
                <figcaption class="personal-figcaption">
                  <img src="./assets/img/subir.png" />
                </figcaption>
              </figure>
            </label>
          </div>
          
    </div>
</div>


            </div>

        </div>
   

           <div class="col-md-12 " style="text-align: center; margin: 5px;">
            <p-button type="ngSubmit" [label]="registroFotografico.idRegistroFotograficoCurso? 'Actualizar': 'Guardar'"
                icon="pi pi-save" styleClass="p-button-success  mb-2 mt-4"></p-button>
        </div>
   

    </form>
</p-dialog>



